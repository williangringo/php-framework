<?php

/* @var $router \Aura\Router\Map */

//------------------------------------------------------------------------------------------------------
// Asset route (for URL generation only)
//------------------------------------------------------------------------------------------------------
$router->add('asset', '/assets/{:f}', [
    'method'   => ['GET'],
    'routable' => false
]);


//------------------------------------------------------------------------------------------------------
// Data Manager Interfaces (access to Adminer for DB and PhpMoAdmin for MongoDB)
//------------------------------------------------------------------------------------------------------
$router->add('dmi_db', '/dmi/db', [
    'values' => [
        'm' => 'app-modules',
        'c' => 'dmi',
        'a' => 'db'
    ],
    'method' => ['GET', 'POST']
]);

$router->add('dmi_mongo', '/dmi/mongo', [
    'values' => [
        'm' => 'app-modules',
        'c' => 'dmi',
        'a' => 'mongo'
    ],
    'method' => ['GET', 'POST']
]);

//------------------------------------------------------------------------------------------------------
// Adding a route group for each Control Panel defined in the config file
//------------------------------------------------------------------------------------------------------
$cpanels = container()->get('config')['app']['cpanels'];

foreach ($cpanels as $cpanel) {
    $router->attach('/' . $cpanel, [
        'params' => [
            'm'  => '([a-zA-Z0-9\-_]+)',
            'c'  => '([a-zA-Z0-9\-_]+)',
            'a'  => '([a-zA-Z0-9\-_]+)',
            'id' => '([a-zA-Z0-9\-_]+)'
        ],
        'method' => ['GET', 'POST'],
        'routes' => [
            $cpanel . '_m'     => [
                'path'   => '/{:m}',
                'values' => [
                    'cpanel' => $cpanel,
                    'm'      => 'base'
                ]
            ],
            $cpanel . '_mc'    => [
                'path'   => '/{:m}/{:c}',
                'values' => [
                    'cpanel' => $cpanel,
                    'm'      => 'base',
                    'c'      => 'index'
                ]
            ],
            $cpanel . '_mca'   => [
                'path'   => '/{:m}/{:c}/{:a}',
                'values' => [
                    'cpanel' => $cpanel,
                    'm'      => 'base',
                    'c'      => 'index',
                    'a'      => 'index'
                ]
            ],
            $cpanel . '_mcaid' => [
                'path'   => '/{:m}/{:c}/{:a}/{:id}',
                'values' => [
                    'cpanel' => $cpanel,
                    'm'      => 'base',
                    'c'      => 'index',
                    'a'      => 'index',
                    'id'     => -1
                ]
            ]
        ]
    ]);
}

//------------------------------------------------------------------------------------------------------
// Module route
//------------------------------------------------------------------------------------------------------
$router->add('m', '/{:m}', [
    'params' => [
        'm' => '([a-zA-Z0-9\-_]+)'
    ],
    'values' => [
        'm' => 'base'
    ],
    'method' => ['GET', 'POST']
]);

//------------------------------------------------------------------------------------------------------
// Module / Controller route
//------------------------------------------------------------------------------------------------------
$router->add('mc', '/{:m}/{:c}', [
    'params' => [
        'm' => '([a-zA-Z0-9\-_]+)',
        'c' => '([a-zA-Z0-9\-_]+)'
    ],
    'values' => [
        'm' => 'base',
        'c' => 'index'
    ],
    'method' => ['GET', 'POST']
]);

//------------------------------------------------------------------------------------------------------
// Module / Controller / Action route
//------------------------------------------------------------------------------------------------------
$router->add('mca', '/{:m}/{:c}/{:a}', [
    'params' => [
        'm' => '([a-zA-Z0-9\-_]+)',
        'c' => '([a-zA-Z0-9\-_]+)',
        'a' => '([a-zA-Z0-9\-_]+)'
    ],
    'values' => [
        'm' => 'base',
        'c' => 'index',
        'a' => 'index'
    ],
    'method' => ['GET', 'POST']
]);

//------------------------------------------------------------------------------------------------------
// Module / Controller / Action / ID route
//------------------------------------------------------------------------------------------------------
$router->add('mcaid', '/{:m}/{:c}/{:a}/{:id}', [
    'params' => [
        'm'  => '([a-zA-Z0-9\-_]+)',
        'c'  => '([a-zA-Z0-9\-_]+)',
        'a'  => '([a-zA-Z0-9\-_]+)',
        'id' => '([a-zA-Z0-9\-_]+)'
    ],
    'values' => [
        'm'  => 'base',
        'c'  => 'index',
        'a'  => 'index',
        'id' => -1
    ],
    'method' => ['GET', 'POST']
]);


